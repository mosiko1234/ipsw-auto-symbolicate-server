# ðŸš€ IPSW Symbol Server v3.1.0 - Symbol Extraction Upgrade

## â— ×”×‘×¢×™×” ×©×–×™×”×™×ª

××ª×” ×¦×•×“×§ ×œ×—×œ×•×˜×™×Ÿ! ×”×ž×¢×¨×›×ª ×”× ×•×›×—×™×ª (v3.0.0) ×¢×•×‘×“×ª ×‘-**"Just-in-time Symbolication"**:

### âŒ ×”×ž×¦×‘ ×”× ×•×›×—×™:
- **Scan IPSW** â†’ ×©×•×ž×¨ ×¨×§ ×ž×˜×-×“×˜×” ×‘×ž×¡×“ ×”× ×ª×•× ×™×
- **Symbolication** â†’ ×ž×©×ª×ž×© ×‘-`ipsw symbolicate` ×¢×œ ×§×‘×¦×™ ×”-IPSW ×‘×–×ž×Ÿ ××ž×ª
- **×§×‘×¦×™ IPSW × ×“×¨×©×™× ×ª×ž×™×“** â†’ ×¦×¨×™×š ×œ×©×ž×•×¨ 9GB+ ×œ×›×œ IPSW
- **××™×˜×™** â†’ ×¦×¨×™×š ×œ×¢×‘×“ IPSW ×‘×›×œ ×¤×¢×

## âœ… ×”×¤×ª×¨×•×Ÿ ×”×—×“×© (v3.1.0)

### ðŸ”„ ×©×™× ×•×™ ××¨×›×™×˜×§×˜×•×¨×”
**×ž×¢×‘×¨ ×œ-"Extract-once, Symbolicate-forever"**:

1. **Scan IPSW** â†’ ×ž×—×œ×¥ ×•×©×•×ž×¨ ××ª ×›×œ ×”×¡×™×ž×‘×•×œ×™× ×‘×ž×¡×“ ×”× ×ª×•× ×™×
2. **Delete IPSW** â†’ × ×™×ª×Ÿ ×œ×ž×—×•×§ ××ª ×§×‘×¦×™ ×”-IPSW (×”×¡×™×ž×‘×•×œ×™× × ×©××¨×™×!)
3. **Symbolicate** â†’ ×ž×©×ª×ž×© ×‘×¡×™×ž×‘×•×œ×™× ×ž×”×ž×¡×“ × ×ª×•× ×™× (×ž×”×™×¨ ×•×™×¢×™×œ)

## ðŸ“Š ×”×©×•×•××ª ×©×™×˜×•×ª

| ×”×‘×“×œ | v3.0.0 (× ×•×›×—×™) | v3.1.0 (×ž×©×•×“×¨×’) |
|------|----------------|-----------------|
| **××—×¡×•×Ÿ** | 9GB+ ×œ×›×œ IPSW | ~90MB ×¡×™×ž×‘×•×œ×™× |
| **×ž×”×™×¨×•×ª** | ××™×˜×™ (×¢×™×‘×•×“ IPSW) | ×ž×”×™×¨ (×“×˜××‘×™×™×¡) |
| **×ª×œ×•×ª** | ×“×•×¨×© IPSW ×ª×ž×™×“ | ×¢×¦×ž××™ ×œ×—×œ×•×˜×™×Ÿ |
| **× ×™×”×•×œ** | ×§×©×” (×§×‘×¦×™× ×’×“×•×œ×™×) | ×§×œ (×¨×§ ×ž×¡×“ × ×ª×•× ×™×) |

## ðŸ›  ×™×™×©×•× ×”×¤×ª×¨×•×Ÿ

### ×©×œ×‘ 1: ×©×“×¨×•×’ ×”×§×•×“
×§×•×‘×¥ `simple_app_with_symbol_extraction.py` ×›×•×œ×œ:

```python
def extract_symbols_from_ipsw(ipsw_path, scan_id):
    """Extract all symbols and store in database"""
    # 1. Extract dyld_shared_cache
    # 2. Extract kernel symbols
    # 3. Store in database
    # 4. Mark IPSW as deletable
```

### ×©×œ×‘ 2: ×©×“×¨×•×’ ×ž×¡×“ ×”× ×ª×•× ×™×
```sql
-- ×”×•×¡×¤×ª ×¢×ž×•×“×•×ª ×—×“×©×•×ª
ALTER TABLE scanned_ipsw ADD COLUMN can_delete_ipsw BOOLEAN DEFAULT FALSE;
ALTER TABLE scanned_ipsw ADD COLUMN kernel_symbols_extracted INTEGER DEFAULT 0;
ALTER TABLE symbols ADD COLUMN symbol_type TEXT;
```

### ×©×œ×‘ 3: ×©×“×¨×•×’ ×”×ª×”×œ×™×š

#### ×¢×‘×•×¨ DevOps:
```bash
# ×¡×™×¨×™×§×” ×¢× ×—×™×œ×•×¥ ×¡×™×ž×‘×•×œ×™×
./add_ipsw.sh --extract-symbols ipsw_file.ipsw

# ×‘×“×™×§×” ×©×”×¡×™×ž×‘×•×œ×™× × ×—×œ×¦×•
curl http://localhost:3993/v1/syms/stats

# ×ž×—×™×§×ª IPSW (×× ×‘×˜×•×—)
rm ipsw_file.ipsw  # ×”×¡×™×ž×‘×•×œ×™× × ×©××¨×™× ×‘×ž×¡×“ ×”× ×ª×•× ×™×!
```

#### ×¢×‘×•×¨ ×ž×¤×ª×—×™×:
```bash
# ×¡×™×ž×‘×•×œ ×¢× ×¡×™×ž×‘×•×œ×™× ×ž×”×ž×¡×“
curl -F "crashlog=@crash.ips" http://localhost:3993/v1/symbolicate
# â†’ ×ª×’×•×‘×”: "Symbolicated using database symbols (no IPSW file needed)"
```

## ðŸŽ¯ ×™×ª×¨×•× ×•×ª ×”×¤×ª×¨×•×Ÿ

### ðŸ’¾ ×—×™×¡×›×•×Ÿ ×‘×ž×§×•×
- **×œ×¤× ×™**: 50GB (5 ×§×‘×¦×™ IPSW Ã— 10GB)
- **××—×¨×™**: 500MB (×¡×™×ž×‘×•×œ×™× ×‘×œ×‘×“)
- **×—×™×¡×›×•×Ÿ**: 99% ×¤×—×•×ª ×ž×§×•×!

### âš¡ ×ž×”×™×¨×•×ª
- **×œ×¤× ×™**: 30-60 ×©× ×™×•×ª (×¢×™×‘×•×“ IPSW)
- **××—×¨×™**: 1-3 ×©× ×™×•×ª (×©××™×œ×ª×ª ×ž×¡×“ × ×ª×•× ×™×)
- **×©×™×¤×•×¨**: ×¤×™ 10-20 ×ž×”×¨ ×™×•×ª×¨!

### ðŸ—ƒ × ×™×”×•×œ
- **×’×™×‘×•×™**: ×¨×§ ×ž×¡×“ × ×ª×•× ×™× (×‘×ž×§×•× ×§×‘×¦×™× ×’×“×•×œ×™×)
- **×¨×©×ª**: ×”×¢×‘×¨×ª ×ž×¡×“ × ×ª×•× ×™× (×‘×ž×§×•× IPSW)
- **×ª×—×–×•×§×”**: ×ž× ×™×¤×•×œ×¦×™×” ×©×œ DB (×‘×ž×§×•× × ×™×”×•×œ ×§×‘×¦×™×)

## ðŸ”„ ×ª×”×œ×™×š ×”×©×“×¨×•×’

### ××•×¤×¦×™×” 1: ×©×“×¨×•×’ ×”×“×¨×’×ª×™
```bash
# ×”×ž×©×š ×œ×¢×‘×•×“ ×¢× ×”×ž×¢×¨×›×ª ×”×§×™×™×ž×ª
docker-compose up -d

# ×”×•×¡×£ ×§×‘×¦×™ IPSW ×—×“×©×™× ×¢× ×—×™×œ×•×¥ ×¡×™×ž×‘×•×œ×™×
./add_ipsw.sh --extract-symbols new_ipsw.ipsw

# ×ž×—×§ IPSWs ×™×©× ×™× ××—×¨×™ ×©×”×¡×™×ž×‘×•×œ×™× × ×—×œ×¦×•
```

### ××•×¤×¦×™×” 2: ×©×“×¨×•×’ ×ž×œ×
```bash
# ×”×—×œ×£ ××ª simple_app.py ×‘×’×¨×¡×” ×”×ž×©×•×“×¨×’×ª
cp simple_app_with_symbol_extraction.py simple_app.py

# ×‘× ×” ×ž×—×“×©
docker-compose build --no-cache
docker-compose up -d

# ×—×œ×¥ ×¡×™×ž×‘×•×œ×™× ×ž×›×œ ×”-IPSWs ×”×§×™×™×ž×™×
for ipsw in ipsw_files/*.ipsw; do
    ./extract_symbols.sh "$ipsw"
done
```

## ðŸ“ˆ ×ª×•×¦××•×ª ×¦×¤×•×™×•×ª

### ×œ××—×¨ ×”×©×“×¨×•×’:
1. **×¡×™×¨×™×§×ª IPSW** â†’ ×›×•×œ×œ ×—×™×œ×•×¥ ×¡×™×ž×‘×•×œ×™× (×—×“ ×¤×¢×ž×™)
2. **×ž×—×™×§×ª IPSW** â†’ ×ž×©×—×¨×¨ ×ž×§×•× (×”×¡×™×ž×‘×•×œ×™× × ×©××¨×™×)
3. **×¡×™×ž×‘×•×œ ×ž×”×™×¨** â†’ ×ž×©×ª×ž×© ×‘×ž×¡×“ ×”× ×ª×•× ×™× (×‘×œ×™ IPSW)

### ×“×•×’×ž×” ×ž×¢×©×™×ª:
```bash
# ×œ×¤× ×™ ×”×©×“×¨×•×’
ls -lh ipsw_files/
# iPhone17,3_18.5_22F76_Restore.ipsw  9.8GB

# ××—×¨×™ ×”×©×“×¨×•×’
curl http://localhost:3993/v1/syms/stats
# {
#   "total_symbols": 2847293,
#   "symbols_size_mb": 89,
#   "can_delete_ipsws": ["iPhone17,3_18.5_22F76_Restore.ipsw"]
# }

rm ipsw_files/iPhone17,3_18.5_22F76_Restore.ipsw  # 9.8GB â†’ 0GB
# ×”×¡×™×ž×‘×•×œ×™× ×¢×“×™×™×Ÿ ×–×ž×™× ×™× ×œ×ž×™×¡×ž×•×š!
```

## ðŸš¨ ×”×ª×¨××•×ª ×—×©×•×‘×•×ª

### âš ï¸ ×œ×¤× ×™ ×ž×—×™×§×ª IPSW
```bash
# ×•×“× ×©×”×¡×™×ž×‘×•×œ×™× × ×—×œ×¦×• ×‘×”×¦×œ×—×”
curl http://localhost:3993/v1/syms/scans | jq '.scans[] | select(.can_delete_ipsw == true)'

# ×‘×“×•×§ ×©×¡×™×ž×‘×•×œ ×¢×•×‘×“
curl -F "crashlog=@test.ips" http://localhost:3993/v1/symbolicate
```

### ðŸ”„ ×’×™×‘×•×™
```bash
# ×’×‘×” ××ª ×ž×¡×“ ×”× ×ª×•× ×™× ×œ×¤× ×™ ×©×“×¨×•×’
docker exec symbol-db pg_dump -U symboluser symbols > symbols_backup.sql

# ×©×—×–×¨ ×‘×ž×§×¨×” ×©×œ ×‘×¢×™×”
docker exec -i symbol-db psql -U symboluser symbols < symbols_backup.sql
```

---

## ðŸŽ‰ ×¡×™×›×•×

×”×©×“×¨×•×’ ×”×–×” ×¤×•×ª×¨ ×‘×“×™×•×§ ××ª ×”×‘×¢×™×” ×©×–×™×”×™×ª:

âœ… **×œ× ×¦×¨×™×š ×™×•×ª×¨ ×§×‘×¦×™ IPSW** ××—×¨×™ ×—×™×œ×•×¥ ×”×¡×™×ž×‘×•×œ×™×  
âœ… **×—×™×¡×›×•×Ÿ ×©×œ 99% ×‘×ž×§×•×** ××—×¡×•×Ÿ  
âœ… **×¡×™×ž×‘×•×œ ×ž×”×™×¨ ×¤×™ 10-20** ×ž×ž×”×™×¨×•×ª ×”× ×•×›×—×™×ª  
âœ… **× ×™×”×•×œ ×¤×©×•×˜** - ×¨×§ ×ž×¡×“ × ×ª×•× ×™×  
âœ… **×’×ž×™×©×•×ª** - ×‘×—×™×¨×” ×ž×ª×™ ×œ×ž×—×•×§ IPSW  

**×”×ª×•×¦××”**: ×ž×¢×¨×›×ª ×™×¢×™×œ×” ×©×ž×ª××™×ž×” ×œ××¨×›×™×•×Ÿ ××¨×•×š ×˜×•×•×—! ðŸš€ 